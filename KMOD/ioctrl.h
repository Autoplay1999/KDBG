#ifndef _IOCTRL_H
#define _IOCTRL_H

#include "global.h"

/*
* I/O communication.
*/

#define KMOD_REQ_PROCESS_ATTACH  CTL_CODE(FILE_DEVICE_UNKNOWN, 0x0100, METHOD_IN_DIRECT, FILE_SPECIAL_ACCESS)

#define KMOD_REQ_MEMORY_READ     CTL_CODE(FILE_DEVICE_UNKNOWN, 0x0200, METHOD_IN_DIRECT, FILE_SPECIAL_ACCESS)
#define KMOD_REQ_MEMORY_WRITE    CTL_CODE(FILE_DEVICE_UNKNOWN, 0x0201, METHOD_IN_DIRECT, FILE_SPECIAL_ACCESS)

typedef struct _REQ_PROCESS_ATTACH
{
  ULONG Pid{};
} REQ_PROCESS_ATTACH, * PREQ_PROCESS_ATTACH;

typedef struct _REQ_MEMORY_READ
{
  ULONG64 Base{};
  PWCHAR  Name{};
  ULONG   Offset{};
  SIZE_T  Size{};
  PVOID   Buffer{};
} REQ_MEMORY_READ, * PREQ_MEMORY_READ;
typedef struct _REQ_MEMORY_WRITE
{
  ULONG64 Base{};
  PWCHAR  Name{};
  ULONG   Offset{};
  SIZE_T  Size{};
  PVOID   Buffer{};
} REQ_MEMORY_WRITE, * PREQ_MEMORY_WRITE;

#endif